---
name: Category Data Model & Core Logic
status: open
created: 2025-09-29T00:51:27Z
updated: 2025-09-29T00:51:27Z
github: [Will be updated when synced to GitHub]
depends_on: [001, 002]
parallel: false
conflicts_with: []
---
# Task: Category Data Model & Core Logic
## Description
계층형 카테고리 시스템의 핵심 로직을 구현합니다. CategoryManager 모듈을 개발하고, 카테고리 트리 구조 관리, 정렬, 검색 기능을 제공합니다.
## Acceptance Criteria
### Must-Have
- [ ] **CategoryManager 모듈**: 카테고리 관리 핵심 로직 구현
- [ ] **계층 구조 관리**: 부모-자식 관계 및 트리 순회 기능
- [ ] **정렬 및 재정렬**: 카테고리 순서 관리 및 재정렬 기능
- [ ] **유효성 검사**: 카테고리 생성/수정/삭제 시 데이터 검증
### Nice-to-Have
- [ ] **카테고리 검색**: 이름 및 경로 기반 검색 기능
- [ ] **통계 정보**: 각 카테고리의 클립 수 집계
- [ ] **빠른 생성**: 즐겨찾기 또는 자주 사용하는 카테고리 기능
## Implementation Details
### CategoryManager API
```javascript
// 카테고리 생성
createCategory({ name, parentId, color }) => Promise<Category>
createRootCategory(name) => Promise<Category>
// 카테고리 조회
getCategory(id) => Promise<Category>
getCategoryTree() => Promise<CategoryTreeNode[]>
getCategoriesByParent(parentId) => Promise<Category[]>
getCategoryPath(id) => Promise<Category[]> // 경로 조회
// 카테고리 수정
updateCategory(id, { name, color }) => Promise<Category>
moveCategory(id, newParentId) => Promise<Category>
reorderCategories(categoryIds) => Promise<void> // 순서 재정렬
// 카테고리 삭제
deleteCategory(id) => Promise<void>
deleteCategoryWithChildren(id) => Promise<void> // 하위 카테고리 포함 삭제
// 유틸리티
validateCategory(category) => boolean
isDescendant(parentId, childId) => Promise<boolean>
getCategoryStats(id) => Promise<{ clipCount: number, subcategoryCount: number }>
```
### 트리 구조 관리
```javascript
// CategoryTreeNode 타입
{
  id: string,
  name: string,
  parentId: string | null,
  children: CategoryTreeNode[],
  depth: number,
  path: string // 경로 문자열 (e.g., "프로젝트/웹개발/clipgo")
}
// 트리 빌딩 로직
buildTree(flatCategories) => CategoryTreeNode[]
flattenTree(treeNode) => Category[]
findTreeNode(tree, id) => CategoryTreeNode | null
```
### 유효성 검사 규칙
- [ ] 이름 중복 체크 (동일 레벨 내)
- [ ] 순환 참조 방지 (부모-자식 관계)
- [ ] 최대 깊이 제한 (3단계)
- [ ] 특수 문자 및 길이 제한
## Dependencies
### 선행 의존성
- Task 001: Project Structure & Manifest Setup
- Task 002: Storage System Implementation
### 후속 의존성
- 드래그&드롭 기능 구현
- 트리 UI 컴포넌트 구현
- 클립-카테고리 연동 기능
## Technical Notes
### 트리 알고리즘
- 중첩 집합 모델 (Nested Set) 또는 부모-자식 모델 선택
- 트리 순회 최적화 (깊이 우선, 너비 우선)
- 경로 캐싱 전략
### 성능 고려사항
- 트리 구조 변경 시 최적화된 업데이트
- 대량의 카테고리 처리 시 성능 보장
- 메모리 사용량 관리
### 동기화 처리
- 여러 컴포넌트 간 상태 동기화
- 트리 구조 변경 시 알림 메커니즘
- Conflict resolution 전략
## Success Criteria
### 기술적 성공 기준
- [ ] 모든 카테고리 관리 기능이 정상 작동
- [ ] 트리 구조가 항상 일관성 유지
- [ ] 계층 구조가 최대 3단계까지 지원됨
- [ ] 부모-자식 관계가 정확하게 유지됨
### 품질 기준
- [ ] API 설계가 직관적이고 일관성 있음
- [ ] 에러 처리가 완전하고 사용자 친화적
- [ ] 트리 구조 변경 시 부작용이 없음
- [ ] 단위 테스트가 모든 주요 기능을 커버함
### 성능 기준
- [ ] 카테고리 생성/수정/삭제 < 100ms
- [ ] 트리 빌딩 < 50ms (100개 카테고리 기준)
- [ ] 경로 조회 < 20ms
- [ ] 메모리 사용량 < 2MB (100개 카테고리 기준)
### 사용자 경험 기준
- [ ] 카테고리 관리가 직관적이고 쉬움
- [ ] 트리 구조 변경이 즉시 반영됨
- [ ] 잘못된 작업이 방지됨 (유효성 검사)
- [ ] 작업 결과가 명확하게 표시됨